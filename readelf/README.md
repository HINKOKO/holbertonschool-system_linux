# **C - ELF: readelf**

## **Learning Objectives**

- **What is the ELF format**

	**ELF** is **NOT** a ***A type of supernatural being in Germanic mythology and folklore*** , it rather stands for <br>
	**E**xecutable and **L**inkable **F**ormat. <br>
	***An ELF defines how instructions are stored in executable code.***
	In C programming, generated by the Compiler and the Linker. <br>
	The Compiler --> produces an object files (containing compiled code and data) <br>
	The Linker --> combines that object files with other object files and libraries to produce an executable.
	By design, the ELF Format is cross-platform, flexible, extensible (support differents Endianesses for instance).

- **What kind of files are in the ELF format**

	Here are some files in the ELF format:
	- **Executable files**, programs that can be run directly by the OS.
	- **Object files**, That is to say compiled code that has not yet been linked into an executable. (extension **.o**)
	- **Shared libraries**, code modules that can be used by mutiple programs at the same time. (extension **.so**)
	- **Core dump files**, when a program crash, the core dump is a "snapshot" of the program's memory at the moment of the crash.
	- **Kernel modules** (in some Unix-like OS).

- **What are the different parts that constitute an ELF file**
	Generally speaking, ELF files are composed of three main parts:
	- ELF Header
	- Program headers or **Segments**
	- Section headers or **Sections**

- **What information are present in the file header**
	```
	ELF Header:
  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 
  Class:                             ELF64
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              EXEC (Executable file)
  Machine:                           Advanced Micro Devices X86-64
  Version:                           0x1
  Entry point address:               0x400500
  Start of program headers:          64 (bytes into file)
  Start of section headers:          6808 (bytes into file)
  Flags:                             0x0
  Size of this header:               64 (bytes)
  Size of program headers:           56 (bytes)
  Number of program headers:         9
  Size of section headers:           64 (bytes)
  Number of section headers:         31
  Section header string table index: 28

	```
	Among the different fields we can find, here are some of interests:
	- **Magic** => ELF starts with **`Magic`** field,  What an intro ! This kind of "Magic" (who's Queen was singing about in 1986) provides information about the file. The first 4 hexadecimals numbers are known as **"the magic number"**, if we look at them carefully we got this: <br>
	45 = E
	4c = F
	46 = F
	Enigma cracked ! we got "ELF" written in the ELF File header magic field.
	Good, and what about the " 7f " ? it represents the file formant and the architecture of the ELF Binary file, **" 7f "** is known as the **"ELF identification byte "** or **"EI_MAGO "**, its purpose is a file identification marker and is always set to the value **" 0x7f "** for ELF Files.
	- **Class** => This value is for specifying the architecture of the file,
	either **32-bit (=01)** or **64-bit (=02)** architecture.
	- **Data** => Data field will get either 01 for **LSB** (Least Significant Bit, little-endian) or 02 for **MSB** (Most Significant Bit, big-endian).
	This value is helpful to correctly interpret the remaining parts within the ELF file.

- **What information are present in the sections header table**
	This "view" of the ELF file is used for linking and relocation, for the executable files, which we are working with in this project,
	we find 4 main sections:
	- `.text` contains executable code, loaded only once and packed into a segment (as it won't change)
	- `.data` initialized data with read and write access rights
	- `.rodata` initialized data with read only access rights
	- `.bss` Uninitialiazed data, read and write access rights
- **What information are present in the program header table**
- **How to parse an ELF file using C structures**
	The ``/usr/include/elf.h`` header file is a standard C header file which defines data structures, constants and macros used to parse and manipulate ELF files.
